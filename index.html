<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>¬°S√∫per Rifa del Oso!</title>
  <meta name="description" content="Rifa de peluche tejido organizada por Yurani. Juega el 5 de septiembre con las 2 √∫ltimas cifras de la Loter√≠a de Medell√≠n. Aqu√≠ publicaremos el n√∫mero ganador durante una semana." />
  <style>
    :root{
      /* Paleta colorida y alegre */
      --bg1:#fff7f5; --bg2:#f0f9ff; --bg3:#fff0f5;
      --card:#ffffff; --ink:#1f2937; --muted:#64748b;
      --brand:#ff3b6a; --brand-2:#7c3aed; --brand-3:#06b6d4;
      --ok:#16a34a; --warn:#b45309; --ring:#ffe4ec;
      --chip:#ffeff4; --chip-ink:#9f1239;
      --border:#e5e7eb;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";color:var(--ink);
      background: radial-gradient(1200px 700px at -10% -10%, var(--bg1), transparent),
                  radial-gradient(1000px 600px at 110% 10%, var(--bg2), transparent),
                  radial-gradient(900px 600px at 50% 120%, var(--bg3), transparent),
                  #fff;}
    header{position:sticky;top:0;z-index:10;background:rgba(255,255,255,.78);backdrop-filter:saturate(180%) blur(10px);border-bottom:1px solid var(--border)}
    .wrap{max-width:1120px;margin:auto;padding:18px}
    .info{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .badge{display:inline-flex;align-items:center;gap:8px;padding:8px 14px;border-radius:999px;font-weight:900;border:1px solid #fee2e2;background:linear-gradient(90deg,var(--bg1),#fff)}
    .badge::before{content:"üéüÔ∏è"}
    .sub{color:var(--muted)}

    .hero{display:grid;grid-template-columns:1fr;gap:18px;align-items:center;margin-top:10px}
    figure{margin:0;border-radius:22px;overflow:hidden;border:1px solid var(--border);box-shadow:0 20px 50px rgba(2,6,23,.08)}
    img.hero-img{width:100%;height:auto;display:block}

    .card{background:var(--card);border:1px solid var(--border);border-radius:22px;box-shadow:0 18px 45px rgba(2,6,23,.06)}
    .grid-card{padding:20px}
    .title{font-size:clamp(28px,5vw,46px);margin:0 0 6px;font-weight:900;background:linear-gradient(90deg,var(--brand),var(--brand-2));-webkit-background-clip:text;background-clip:text;color:transparent}
    .lead{margin:0 0 10px;color:#334155}

    .legend{display:flex;gap:14px;align-items:center;color:#64748b;font-size:14px;margin:8px 0}
    .dot{width:16px;height:16px;border-radius:6px;border:1px solid var(--border);background:#fff}
    .dot.sold{background:#f4f4f5;display:grid;place-items:center}
    .dot.sold::after{content:"üêª";font-size:12px}

    .controls{display:grid;grid-template-columns:1fr;gap:12px;margin:10px 0}
    label{font-size:14px;color:#374151}
    select, textarea{width:100%;padding:12px;border-radius:14px;border:1px solid var(--border);background:#fff;outline:none}
    select:focus, textarea:focus{box-shadow:0 0 0 8px var(--ring);border-color:#fecdd3}

    .cta{display:flex;gap:10px;flex-wrap:wrap;margin-top:6px}
    .btn{border:none;cursor:pointer;padding:10px 16px;border-radius:14px;font-weight:900;letter-spacing:.2px}
    .btn.primary{background:linear-gradient(90deg,var(--brand),var(--brand-2));color:#fff}
    .btn.ok{background:linear-gradient(90deg,#22c55e,#16a34a);color:#fff}
    .btn.ghost{background:#fff;border:1px solid var(--border);color:#111827}
    .btn.warn{background:linear-gradient(90deg,#f59e0b,#b45309);color:#fff}

    .chips{display:flex;gap:8px;flex-wrap:wrap}
    .chip{background:var(--chip);color:var(--chip-ink);border:1px solid #ffd5e1;padding:6px 10px;border-radius:999px;font-weight:800}

    .board{--cols:10;display:grid;grid-template-columns:repeat(var(--cols),1fr);gap:8px;margin-top:14px}
    .cell{position:relative;aspect-ratio:1;display:grid;place-items:center;border:1px solid var(--border);border-radius:16px;background:#fff;font-weight:900;font-size:clamp(12px,2.8vw,18px);user-select:none}
    .cell.admin{cursor:pointer;transition:transform .15s, box-shadow .15s}
    .cell.admin:hover{transform:translateY(-1px);box-shadow:0 10px 22px rgba(2,6,23,.1)}
    .cell.sold{color:#a1a1aa}
    .cell.sold::after{content:"üêª";position:absolute;inset:0;display:grid;place-items:center;font-size:clamp(20px,4.8vw,30px)}

    .note{font-size:14px;color:#555;margin-top:8px}
    .winning-banner{margin-top:10px;padding:10px 14px;border-radius:12px;background:#fff6e7;border:1px dashed #ffc977;color:#7a4900}

    footer{padding:30px 20px;color:#64748b;text-align:center}

    @media (min-width:900px){
      .hero{grid-template-columns:1.1fr .9fr}
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="info">
        <span class="badge">¬°S√∫per Rifa del Oso! ¬∑ Organiza: <b>Yurani</b></span>
        <span class="sub">Juega el <b>5 de septiembre</b> con las <b>2 √∫ltimas cifras</b> de la Loter√≠a de Medell√≠n. Aqu√≠ anunciaremos el <b>ganador</b> por una semana.</span>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <figure class="card">
        <!-- La imagen del osito se controla con la variable CONFIG.IMAGE_SRC -->
        <img id="heroImg" class="hero-img" src="" alt="Peluche tejido en rifa" />
      </figure>

      <div class="grid-card card">
        <h1 class="title">G√°nate este hermoso peluche tejido</h1>
        <p class="lead">¬°An√≠mate! Ll√©vate un numerito y participa. Pocos cupos, mucha suerte y mucho amor tejido üíñ <b>Valor: $2.000</b></p>

        <div class="controls">
          <div>
            <label for="selNum">Elige uno o varios n√∫meros disponibles</label>
            <select id="selNum" multiple size="8" aria-label="N√∫meros disponibles"></select>
            <div class="chips" id="chips"></div>
          </div>
          <div class="cta">
            <button id="btnApartar" class="btn ok">üì≤ Apartar por WhatsApp</button>
            <button id="btnCompartir" class="btn ghost">üîó Compartir esta rifa</button>
          </div>
          <div class="legend" aria-hidden="true">
            <span class="dot"></span> Disponible
            <span class="dot sold"></span> Vendido
          </div>
        </div>

        <div id="board" class="board" role="grid" aria-label="Cuadr√≠cula de la rifa (00 a 99)"></div>

        <p class="note">Publicaremos aqu√≠ el <b>n√∫mero ganador</b> durante una semana despu√©s del sorteo. ‚úîÔ∏è</p>
        <div id="winning" class="winning-banner" hidden></div>

        <div id="adminBox" class="note" hidden>
          <hr style="border:none;border-top:1px solid var(--border);margin:14px 0">
          <strong>Modo admin:</strong> pega n√∫meros <em>comprados</em> (separados por coma/espacio) y aplica.
          <div class="controls">
            <textarea id="compradosInput" rows="3" placeholder="Ej.: 03, 14, 27, 33"></textarea>
            <div class="cta">
              <button id="btnAplicar" class="btn primary">Aplicar comprados</button>
              <button id="btnReset" class="btn warn">Restablecer tablero</button>
            </div>
          </div>
          <small>Para mostrar este panel a√±ade <code>#admin=1</code> a la URL.</small>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <small>Organiza: <b>Yurani</b>. Reglas: gana quien coincida con las 2 √∫ltimas cifras del premio mayor de la Loter√≠a de Medell√≠n del 5 de septiembre.</small>
  </footer>

  <script>
    // ================== CONFIGURACI√ìN (f√°cil para GitHub Pages) ==================
    const CONFIG = {
      IMAGE_SRC: 'rifa_oso.jpg',     // üëâ Ruta/archivo de la imagen del osito
      ORGANIZER: 'Yurani',
      WHATS_NUMBER: '573042133403'   // +57 304 2133403 en formato API
    };

    // Baseline de DISPONIBLES (todo lo dem√°s es vendido por defecto)
    // Puedes editar esta lista si cambian los cupos iniciales.
    const BASE_AVAILABLE = [
      3,6,7,10,11,12,14,15,21,23,24,26,30,31,33,34,35,36,40,41,42,43,44,46,47,49,
      50,51,53,54,55,56,58,59,60,61,62,64,65,66,68,69,70,71,72,74,75,76,78,79,80,
      81,83,84,85,86,88,90,91,92,93,94,96
    ].map(n => (String(n).padStart(2,'0')));

    // ================== URL Params: admin & comprados & ganador ==================
    const params = new URLSearchParams(location.search + (location.hash.includes('=')? location.hash.replace('#','&') : ''));
    const IS_ADMIN = params.get('admin') === '1';
    const COMPRADOS_PARAM = (params.get('comprados')||'').split(/[\s,]+/).filter(Boolean).map(v=>v.padStart(2,'0'));

    // Estado local (solo en este navegador)
    const saved = localStorage.getItem('rifa-oso-estado');
    const state = saved ? JSON.parse(saved) : {}; // { '00':true(sold) }
    const save = () => localStorage.setItem('rifa-oso-estado', JSON.stringify(state));

    const numbers = Array.from({length:100}, (_,i)=> String(i).padStart(2,'0'));
    const compradoSet = new Set(COMPRADOS_PARAM);

    // Imagen del h√©roe
    document.getElementById('heroImg').src = CONFIG.IMAGE_SRC;

    // --- helpers ---
    const isDefaultSold = (num) => !BASE_AVAILABLE.includes(num);
    const isSold = (num) => (state[num] ?? (isDefaultSold(num) || compradoSet.has(num))) === true;

    const board = document.getElementById('board');
    const sel = document.getElementById('selNum');
    const chips = document.getElementById('chips');

    function renderBoard(){
      board.innerHTML = '';
      numbers.forEach(num => {
        const sold = isSold(num);
        const cell = document.createElement('div');
        cell.className = 'cell' + (sold ? ' sold' : '') + (IS_ADMIN ? ' admin' : '');
        cell.textContent = num;
        if(IS_ADMIN){
          cell.title = sold ? 'Vendido (clic para liberar)' : 'Disponible (clic para vender)';
          cell.onclick = () => { state[num] = !sold; save(); renderAll(); };
        }
        board.appendChild(cell);
      });
    }

    function disponiblesActuales(){
      return numbers.filter(n => !isSold(n));
    }

    function renderSelect(){
      const list = disponiblesActuales();
      sel.innerHTML = '';
      if(list.length === 0){
        const opt = document.createElement('option');
        opt.textContent = 'Sin cupos por ahora';
        opt.disabled = true; opt.selected = true;
        sel.appendChild(opt);
      } else {
        list.forEach(n => {
          const opt = document.createElement('option');
          opt.value = n; opt.textContent = n;
          sel.appendChild(opt);
        });
      }
      renderChips();
    }

    function renderChips(){
      chips.innerHTML = '';
      const values = Array.from(sel.selectedOptions).map(o=>o.value);
      values.forEach(v => {
        const span = document.createElement('span');
        span.className = 'chip';
        span.textContent = v;
        chips.appendChild(span);
      });
    }

    sel.addEventListener('change', renderChips);

    // WhatsApp
    document.getElementById('btnApartar').onclick = () => {
      const chosen = Array.from(sel.selectedOptions).map(o=>o.value);
      const msg = chosen.length
        ? `Hola üëã, quiero participar en la *S√∫per Rifa del Oso* organizada por ${CONFIG.ORGANIZER}. Deseo apartar los n√∫meros: ${chosen.join(', ')}. ¬øMe confirmas por favor?`
        : `Hola üëã, quiero participar en la *S√∫per Rifa del Oso* organizada por ${CONFIG.ORGANIZER}. ¬øCu√°les n√∫meros tienes disponibles? Quiero elegir y apartar.`;
      const url = `https://api.whatsapp.com/send?phone=${CONFIG.WHATS_NUMBER}&text=${encodeURIComponent(msg)}`;
      window.open(url, '_blank');
    };

    document.getElementById('btnCompartir').onclick = async () => {
      try{ await navigator.clipboard.writeText(location.href); alert('Enlace copiado ‚úÖ'); }
      catch{ alert('No se pudo copiar el enlace'); }
    };

    // Ganador (hash o query: ganador=NN)
    const ganador = params.get('ganador');
    if(ganador){
      const bn = ganador.padStart(2,'0');
      const win = document.getElementById('winning');
      win.hidden = false;
      win.textContent = `N√∫mero ganador: ${bn}. Este aviso permanecer√° visible durante una semana.`;
    }

    function renderAll(){ renderBoard(); renderSelect(); }
    renderAll();

    // Panel admin
    const adminBox = document.getElementById('adminBox');
    adminBox.hidden = !IS_ADMIN;
    if(IS_ADMIN){
      const ta = document.getElementById('compradosInput');
      ta.value = Array.from(compradoSet).join(', ');
      document.getElementById('btnAplicar').onclick = () => {
        const list = ta.value.split(/[\s,]+/).filter(Boolean).map(v=>v.padStart(2,'0'));
        compradoSet.clear(); list.forEach(x=>compradoSet.add(x));
        renderAll();
      };
      document.getElementById('btnReset').onclick = () => {
        if(confirm('¬øRestablecer tablero a su estado inicial?')){
          localStorage.removeItem('rifa-oso-estado');
          for(const k in state) delete state[k];
          renderAll();
        }
      };
    }
  </script>
</body>
</html>
